%% calib

if exist('dobot') == 0	
    dobotinit	
end

%% points
%{
p1: q = -48.4468
   54.7384
   26.2542
  -80.9926
X: 103.78
Y: -117.54
Z: 6.43


p2: -36.1075
   64.7460
   -2.7898
  -61.9562
X: 179.50
Y: -133.82
Z: 12.70


p3: 
-8.5308
   66.9930
    3.5906
  -70.5835

X: 205.5600
Y: -31.84
Z: 0

p4: -10.4668
   36.2287
   41.1518
  -77.3805
X: 123.32
y: -23.54
Z: 25.48


%}


A = zeros(12,12);

qm = [-48.4468;   54.7384;   26.2542;  -80.9926];
Pm1 = [103.78;-117.54; 6.43];
R01 = rot(h1, pi*(180^-1)*qm(1));
R02 = R01*rot(h2,pi*(180^-1)*qm(2));
R03 = R02*rot(h3,pi*(180^-1)*qm(3));
R04 = R03*rot(h4,pi*(180^-1)*(qm(4)));

A(1:3,:) = [eye(3) R02 R03 R04];
qm = [-36.1075;   64.7460;   -2.7898;  -61.9562];
Pm2 = [179.50; -133.82; 12.70];

R01 = rot(h1, pi*(180^-1)*qm(1));
R02 = R01*rot(h2,pi*(180^-1)*qm(2));
R03 = R02*rot(h3,pi*(180^-1)*qm(3));
R04 = R03*rot(h4,pi*(180^-1)*(qm(4)));

A(4:6,:) = [eye(3) R02 R03 R04];

qm=[-8.5308;   66.9930;    3.5906;  -70.5835];
Pm3=[ 205.5600; -31.84; 0];
R01 = rot(h1, pi*(180^-1)*qm(1));
R02 = R01*rot(h2,pi*(180^-1)*qm(2));
R03 = R02*rot(h3,pi*(180^-1)*qm(3));
R04 = R03*rot(h4,pi*(180^-1)*(qm(4)));

A(7:9,:) = [eye(3) R02 R03 R04];

qm=[ -10.4668;   36.2287;   41.1518;  -77.3805];
Pm4=[ 123.32; -23.54; 25.48];
R01 = rot(h1, pi*(180^-1)*qm(1));
R02 = R01*rot(h2,pi*(180^-1)*qm(2));
R03 = R02*rot(h3,pi*(180^-1)*qm(3));
R04 = R03*rot(h4,pi*(180^-1)*(qm(4)));

A(10:12,:) = [eye(3) R02 R03 R04];

B = [Pm1;Pm2;Pm3;Pm4];
xc = [p01;p23;p34;p4T];
[U S V]=svd(A);

x = V*(diag(diag(S).^-1)*(U.'*B));
x2 = pinv(A)*B;
p01m=x(1:3);
p12m=zz;
p23m=x(4:6);
p34m=x(7:9);
p4Tm=x(10:12);

A*xc-B



